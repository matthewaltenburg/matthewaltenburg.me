{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/Virtual Makeup C++/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Matthew Altenburg Portfolio","author":"Matthew Altenburg"}},"markdownRemark":{"id":"a9c0ff9e-6a04-5741-8c84-e717befe2371","excerpt":"This is the second version of the makeup application written in C++. Why do this? Because c++ runs faster than python and much easier to integrate into Qt as aâ€¦","html":"<p>This is the second version of the makeup application written in C++. Why do this? Because c++ runs faster than python and much easier to integrate into Qt as a QML app for deployment on several platforms including linux, android, iOS and Windows.</p>\n<p>I like first building in Python because it's fast. Then converting to C++ so that I get a better understanding of how I want the application to work. Then if I am happy with the result, I can incorporate it into Qt as a class.</p>\n<p>With this application and my build process, I quickly started to realize that I was not going to be able to get the sunglasses features working well. But I also learned that the lipstick function was very popular especially the with my dauther who love the ability to adjust the color and intensity of the lipstick.</p>\n<h2><a href=\"https://github.com/matthewaltenburg/virtual_makeup_opencv.git\" target=\"_blank\">Github code repository</a></h2>\n<p align=\"center\">\n<iframe\n    style=\"align:center\"\n    width=\"640\"\n    height=\"480\"\n    src=\"https://www.youtube.com/embed/uIhbzM1sGLo\"\n    frameborder=\"0\"\n    allowfullscreen\n>\n</iframe>\n</p>\n<h2>Overview diagram of the project</h2>\n<figure style=\"text-align: center;\">\n  <img src=\"/files/1575e43bdedd7467297b1ff46272a4ff/lip.drawio.svg\" alt=\"Image input and what is expected as output diagram\">\n  <figcaption>Input an image and output a picture with the alterations overview.</figcaption>\n</figure>\n<h2>C++ code</h2>\n<div class=\"gatsby-highlight\" data-language=\"cpp\"><pre class=\"language-cpp\"><code class=\"language-cpp\"><span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;iostream></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/opencv.hpp></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;opencv2/imgproc.hpp></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dlib/opencv.h></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dlib/image_processing/frontal_face_detector.h></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dlib/image_processing.h></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dlib/image_io.h></span></span>\n<span class=\"token macro property\"><span class=\"token directive-hash\">#</span><span class=\"token directive keyword\">include</span> <span class=\"token string\">&lt;dlib/gui_widgets.h></span></span>\n\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> cv<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> std<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token keyword\">namespace</span> dlib<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">int</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// Main window name</span>\n  String windowName <span class=\"token operator\">=</span> <span class=\"token string\">\"Main Window\"</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Name of the main working window</span>\n  <span class=\"token function\">namedWindow</span><span class=\"token punctuation\">(</span>windowName<span class=\"token punctuation\">,</span> WINDOW_NORMAL<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// file paths</span>\n  String girl <span class=\"token operator\">=</span> <span class=\"token string\">\"girl.jpg\"</span><span class=\"token punctuation\">;</span>\n  String family <span class=\"token operator\">=</span> <span class=\"token string\">\"family.jpg\"</span><span class=\"token punctuation\">;</span>\n  String imputImg <span class=\"token operator\">=</span> girl<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// images</span>\n  Mat image <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span>imputImg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// Main image</span>\n  array2d<span class=\"token operator\">&lt;</span><span class=\"token keyword\">unsigned</span> <span class=\"token keyword\">char</span><span class=\"token operator\">></span> image_gray<span class=\"token punctuation\">;</span>\n  <span class=\"token function\">load_image</span><span class=\"token punctuation\">(</span>image_gray<span class=\"token punctuation\">,</span> imputImg<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// dlib image</span>\n  <span class=\"token comment\">// mask</span>\n  Mat mask <span class=\"token operator\">=</span> <span class=\"token class-name\">Mat</span><span class=\"token double-colon punctuation\">::</span><span class=\"token function\">zeros</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">.</span><span class=\"token function\">type</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Glasses image</span>\n  Mat image_glasses <span class=\"token operator\">=</span> <span class=\"token function\">imread</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"glasses.png\"</span><span class=\"token punctuation\">,</span> IMREAD_UNCHANGED<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  Mat glasses_split<span class=\"token punctuation\">[</span><span class=\"token number\">4</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span>image_glasses<span class=\"token punctuation\">,</span> glasses_split<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  std<span class=\"token double-colon punctuation\">::</span>vector<span class=\"token operator\">&lt;</span>Mat<span class=\"token operator\">></span> channels<span class=\"token punctuation\">;</span>\n  channels<span class=\"token punctuation\">.</span><span class=\"token function\">push_back</span><span class=\"token punctuation\">(</span>glasses_split<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  channels<span class=\"token punctuation\">.</span><span class=\"token function\">push_back</span><span class=\"token punctuation\">(</span>glasses_split<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  channels<span class=\"token punctuation\">.</span><span class=\"token function\">push_back</span><span class=\"token punctuation\">(</span>glasses_split<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>channels<span class=\"token punctuation\">,</span> image_glasses<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// HSV image</span>\n  Mat imgHSV<span class=\"token punctuation\">;</span>\n  cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">cvtColor</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> imgHSV<span class=\"token punctuation\">,</span> COLOR_BGR2HSV<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// // testing dlib image</span>\n  <span class=\"token comment\">// image_window win;</span>\n  <span class=\"token comment\">// win.clear_overlay();</span>\n  <span class=\"token comment\">// win.set_image(image_gray);</span>\n  <span class=\"token comment\">// Checks for failure</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n    cout <span class=\"token operator\">&lt;&lt;</span> <span class=\"token string\">\"Could not open or find the image please add corret file path to image.\"</span> <span class=\"token operator\">&lt;&lt;</span> endl<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// create face detector abject</span>\n  frontal_face_detector faceDetector <span class=\"token operator\">=</span> <span class=\"token function\">get_frontal_face_detector</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// find faces in image</span>\n  std<span class=\"token double-colon punctuation\">::</span>vector<span class=\"token operator\">&lt;</span>dlib<span class=\"token double-colon punctuation\">::</span>rectangle<span class=\"token operator\">></span> faces <span class=\"token operator\">=</span> <span class=\"token function\">faceDetector</span><span class=\"token punctuation\">(</span>image_gray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// // Testing image</span>\n  <span class=\"token comment\">// image_window win;</span>\n  <span class=\"token comment\">// win.clear_overlay();</span>\n  <span class=\"token comment\">// win.set_image(image_gray);</span>\n  <span class=\"token comment\">// win.add_overlay(faces, rgb_pixel(255,0,0));</span>\n\n  <span class=\"token comment\">// Load the 68 point detector</span>\n  String face68 <span class=\"token operator\">=</span> <span class=\"token string\">\"shape_predictor_68_face_landmarks.dat\"</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// The landmark detector is implemented</span>\n  shape_predictor landmarkDetector<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// Load the landmark model</span>\n  <span class=\"token function\">deserialize</span><span class=\"token punctuation\">(</span>face68<span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> landmarkDetector<span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">//Create trackbar to change lip color</span>\n  cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">createTrackbar</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hue\"</span><span class=\"token punctuation\">,</span> windowName<span class=\"token punctuation\">,</span> <span class=\"token keyword\">nullptr</span><span class=\"token punctuation\">,</span> <span class=\"token number\">180</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">setTrackbarPos</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hue\"</span><span class=\"token punctuation\">,</span> windowName<span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//Create trackbar to change lip color saturation</span>\n  cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">createTrackbar</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Saturation\"</span><span class=\"token punctuation\">,</span> windowName<span class=\"token punctuation\">,</span> <span class=\"token keyword\">nullptr</span><span class=\"token punctuation\">,</span> <span class=\"token number\">155</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">setTrackbarPos</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Saturation\"</span><span class=\"token punctuation\">,</span> windowName<span class=\"token punctuation\">,</span> <span class=\"token number\">155</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">//Create trackbar to change glasses color</span>\n  cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">createTrackbar</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Black_White\"</span><span class=\"token punctuation\">,</span> windowName<span class=\"token punctuation\">,</span> <span class=\"token keyword\">nullptr</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">setTrackbarPos</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Black_White\"</span><span class=\"token punctuation\">,</span> windowName<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">int</span> hueSlider <span class=\"token operator\">=</span> <span class=\"token function\">getTrackbarPos</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hue\"</span><span class=\"token punctuation\">,</span> windowName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> satSlider <span class=\"token operator\">=</span> <span class=\"token function\">getTrackbarPos</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Saturation\"</span><span class=\"token punctuation\">,</span> windowName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">int</span> black_whiteSlider <span class=\"token operator\">=</span> <span class=\"token function\">getTrackbarPos</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Black_White\"</span><span class=\"token punctuation\">,</span> windowName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Split the image</span>\n    Mat splitImage<span class=\"token punctuation\">[</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">split</span><span class=\"token punctuation\">(</span>imgHSV<span class=\"token punctuation\">,</span> splitImage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Set the color</span>\n    splitImage<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">setTo</span><span class=\"token punctuation\">(</span><span class=\"token function\">Scalar</span><span class=\"token punctuation\">(</span>hueSlider<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Set the saturation</span>\n    splitImage<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">setTo</span><span class=\"token punctuation\">(</span><span class=\"token function\">Scalar</span><span class=\"token punctuation\">(</span>satSlider<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Merge the images channels.</span>\n    <span class=\"token function\">merge</span><span class=\"token punctuation\">(</span>splitImage<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> imgHSV<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    Mat lipImage<span class=\"token punctuation\">;</span>\n    cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">cvtColor</span><span class=\"token punctuation\">(</span>imgHSV<span class=\"token punctuation\">,</span> lipImage<span class=\"token punctuation\">,</span> COLOR_HSV2BGR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Loop over all detected face rectangles</span>\n    <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> faces<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// For every face rectangle, run landmarkDetector</span>\n      full_object_detection landmarks <span class=\"token operator\">=</span> <span class=\"token function\">landmarkDetector</span><span class=\"token punctuation\">(</span>image_gray<span class=\"token punctuation\">,</span> faces<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">//  Points for the glasses</span>\n      Point left_point <span class=\"token operator\">=</span> <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span>landmarks<span class=\"token punctuation\">.</span><span class=\"token function\">part</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">x</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> landmarks<span class=\"token punctuation\">.</span><span class=\"token function\">part</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      Point middle_point <span class=\"token operator\">=</span> <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span>landmarks<span class=\"token punctuation\">.</span><span class=\"token function\">part</span><span class=\"token punctuation\">(</span><span class=\"token number\">27</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">x</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> landmarks<span class=\"token punctuation\">.</span><span class=\"token function\">part</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      Point right_point <span class=\"token operator\">=</span> <span class=\"token function\">Point</span><span class=\"token punctuation\">(</span>landmarks<span class=\"token punctuation\">.</span><span class=\"token function\">part</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">x</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> landmarks<span class=\"token punctuation\">.</span><span class=\"token function\">part</span><span class=\"token punctuation\">(</span><span class=\"token number\">27</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// // Get the distance between the eye points for scaling the glasses image</span>\n      <span class=\"token keyword\">float</span> distance_points <span class=\"token operator\">=</span> std<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">hypot</span><span class=\"token punctuation\">(</span>left_point<span class=\"token punctuation\">.</span>x <span class=\"token operator\">-</span> right_point<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">,</span> left_point<span class=\"token punctuation\">.</span>y <span class=\"token operator\">-</span> right_point<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// Scale the glasses image by the distance points</span>\n      <span class=\"token keyword\">float</span> scale_factor <span class=\"token operator\">=</span> distance_points <span class=\"token operator\">/</span> image_glasses<span class=\"token punctuation\">.</span>cols<span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// resize the glasses image to fit the faces in the image</span>\n      cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">resize</span><span class=\"token punctuation\">(</span>image_glasses<span class=\"token punctuation\">,</span> image_glasses<span class=\"token punctuation\">,</span> cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">Size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> scale_factor<span class=\"token punctuation\">,</span> scale_factor<span class=\"token punctuation\">,</span> INTER_LINEAR<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">int</span> width <span class=\"token operator\">=</span> image_glasses<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>width<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">int</span> height <span class=\"token operator\">=</span> image_glasses<span class=\"token punctuation\">.</span><span class=\"token function\">size</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>height<span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">int</span> y <span class=\"token operator\">=</span> middle_point<span class=\"token punctuation\">.</span>y<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">int</span> x <span class=\"token operator\">=</span> middle_point<span class=\"token punctuation\">.</span>x<span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>x <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">++</span>x<span class=\"token punctuation\">;</span>\n\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>y <span class=\"token operator\">%</span> <span class=\"token number\">2</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n        <span class=\"token operator\">++</span>y<span class=\"token punctuation\">;</span>\n\n      x <span class=\"token operator\">=</span> x <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>width <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      y <span class=\"token operator\">=</span> y <span class=\"token operator\">-</span> <span class=\"token punctuation\">(</span>height <span class=\"token operator\">/</span> <span class=\"token number\">2</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      Mat roi<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>black_whiteSlider <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{</span>\n        cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span><span class=\"token function\">image</span><span class=\"token punctuation\">(</span><span class=\"token function\">Range</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> height <span class=\"token operator\">+</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Range</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> width <span class=\"token operator\">+</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> image_glasses<span class=\"token punctuation\">,</span> roi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>black_whiteSlider <span class=\"token operator\">==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{</span>\n        cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">subtract</span><span class=\"token punctuation\">(</span><span class=\"token function\">image</span><span class=\"token punctuation\">(</span><span class=\"token function\">Range</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> height <span class=\"token operator\">+</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Range</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> width <span class=\"token operator\">+</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> image_glasses<span class=\"token punctuation\">,</span> roi<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      roi<span class=\"token punctuation\">.</span><span class=\"token function\">copyTo</span><span class=\"token punctuation\">(</span><span class=\"token function\">image</span><span class=\"token punctuation\">(</span><span class=\"token function\">Range</span><span class=\"token punctuation\">(</span>y<span class=\"token punctuation\">,</span> height <span class=\"token operator\">+</span> y<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token function\">Range</span><span class=\"token punctuation\">(</span>x<span class=\"token punctuation\">,</span> width <span class=\"token operator\">+</span> x<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// points for the lips</span>\n      std<span class=\"token double-colon punctuation\">::</span>vector<span class=\"token operator\">&lt;</span>cv<span class=\"token double-colon punctuation\">::</span>Point<span class=\"token operator\">></span> lipPoints<span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">// get lip points</span>\n      <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">int</span> i <span class=\"token operator\">=</span> <span class=\"token number\">48</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;=</span> <span class=\"token number\">67</span><span class=\"token punctuation\">;</span> <span class=\"token operator\">++</span>i<span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">{</span>\n        lipPoints<span class=\"token punctuation\">.</span><span class=\"token function\">push_back</span><span class=\"token punctuation\">(</span><span class=\"token function\">Point</span><span class=\"token punctuation\">(</span>landmarks<span class=\"token punctuation\">.</span><span class=\"token function\">part</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">x</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> landmarks<span class=\"token punctuation\">.</span><span class=\"token function\">part</span><span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">y</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token comment\">// create an area of white points on the mask</span>\n      cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">fillPoly</span><span class=\"token punctuation\">(</span>mask<span class=\"token punctuation\">,</span> lipPoints<span class=\"token punctuation\">,</span> <span class=\"token function\">Scalar</span><span class=\"token punctuation\">(</span><span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">,</span> <span class=\"token number\">255</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">// create a reverse mask</span>\n    Mat reverse_mask<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">bitwise_not</span><span class=\"token punctuation\">(</span>mask<span class=\"token punctuation\">,</span> reverse_mask<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Mask the alternated color image isolating the lips</span>\n    Mat lips<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">bitwise_and</span><span class=\"token punctuation\">(</span>lipImage<span class=\"token punctuation\">,</span> mask<span class=\"token punctuation\">,</span> lips<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Use a mask to remove the lips from the image</span>\n    Mat not_lips<span class=\"token punctuation\">;</span>\n    <span class=\"token function\">bitwise_and</span><span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">,</span> reverse_mask<span class=\"token punctuation\">,</span> not_lips<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// add the lip and the no lips images together</span>\n    image <span class=\"token operator\">=</span> not_lips <span class=\"token operator\">+</span> lips<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// Show main image</span>\n    cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">imshow</span><span class=\"token punctuation\">(</span>windowName<span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//if user press 'ESC' key</span>\n    <span class=\"token keyword\">int</span> iKey <span class=\"token operator\">=</span> <span class=\"token function\">waitKey</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>iKey <span class=\"token operator\">==</span> <span class=\"token number\">27</span><span class=\"token punctuation\">)</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  cv<span class=\"token double-colon punctuation\">::</span><span class=\"token function\">destroyWindow</span><span class=\"token punctuation\">(</span>windowName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// destroy the created window</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n</code></pre></div>","frontmatter":{"title":"Virtual Makeup C++","date":"2021, Nov 08","tags":["OpenCV","c++","Dlib"],"img":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMFAgT/xAAUAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAG8p8h+NrkMTYC6hD//xAAaEAEAAwADAAAAAAAAAAAAAAABAAIDERIx/9oACAEBAAEFArJnHWa0631OdbA2cxjezPGzP//EABYRAQEBAAAAAAAAAAAAAAAAABABEf/aAAgBAwEBPwHCH//EABcRAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQIBAT8BpR5//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIQIQEjH/2gAIAQEABj8CpTkxdYRJXmsYLOm7Fr//xAAbEAEBAQEAAwEAAAAAAAAAAAABEQAhQVFxof/aAAgBAQABPyGoGi5D8BmlSimiKUBuCPevboUeN2Qhugk5TMJ83//aAAwDAQACAAMAAAAQ+PCB/8QAGBEBAQADAAAAAAAAAAAAAAAAAQAQITH/2gAIAQMBAT8QBJvF7f/EABcRAQEBAQAAAAAAAAAAAAAAAAABITH/2gAIAQIBAT8QtJhyj//EABwQAQEBAAIDAQAAAAAAAAAAAAERACExQVFhcf/aAAgBAQABPxAZSzEFcACukBMoIAvzWQqFkvnEbVU1B6us6JB+Z0nQrx36yS65g68YTA6b/9k="},"images":{"fallback":{"src":"/static/9156cfc6cd38dce72186cedd98de3ece/f1f81/output.jpg","srcSet":"/static/9156cfc6cd38dce72186cedd98de3ece/2bd2c/output.jpg 750w,\n/static/9156cfc6cd38dce72186cedd98de3ece/f1f81/output.jpg 799w","sizes":"100vw"},"sources":[{"srcSet":"/static/9156cfc6cd38dce72186cedd98de3ece/0d6fe/output.avif 750w,\n/static/9156cfc6cd38dce72186cedd98de3ece/d1fbb/output.avif 799w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/9156cfc6cd38dce72186cedd98de3ece/4ea96/output.webp 750w,\n/static/9156cfc6cd38dce72186cedd98de3ece/437f6/output.webp 799w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.9762202753441803}}}}}},"pageContext":{"slug":"/Virtual Makeup C++/","previous":{"fields":{"slug":"/Virtual Makeup Python/"},"frontmatter":{"title":"Virtual Makeup Python","tags":["OpenCV","Python","Dlib"],"img":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMFAgT/xAAUAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAG8p8h+NrkMTYC6hD//xAAaEAEAAwADAAAAAAAAAAAAAAABAAIDERIx/9oACAEBAAEFArJnHWa0631OdbA2cxjezPGzP//EABYRAQEBAAAAAAAAAAAAAAAAABABEf/aAAgBAwEBPwHCH//EABcRAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQIBAT8BpR5//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIQIQEjH/2gAIAQEABj8CpTkxdYRJXmsYLOm7Fr//xAAbEAEBAQEAAwEAAAAAAAAAAAABEQAhQVFxof/aAAgBAQABPyGoGi5D8BmlSimiKUBuCPevboUeN2Qhugk5TMJ83//aAAwDAQACAAMAAAAQ+PCB/8QAGBEBAQADAAAAAAAAAAAAAAAAAQAQITH/2gAIAQMBAT8QBJvF7f/EABcRAQEBAQAAAAAAAAAAAAAAAAABITH/2gAIAQIBAT8QtJhyj//EABwQAQEBAAIDAQAAAAAAAAAAAAERACExQVFhcf/aAAgBAQABPxAZSzEFcACukBMoIAvzWQqFkvnEbVU1B6us6JB+Z0nQrx36yS65g68YTA6b/9k="},"images":{"fallback":{"src":"/static/9156cfc6cd38dce72186cedd98de3ece/f1f81/output.jpg","srcSet":"/static/9156cfc6cd38dce72186cedd98de3ece/2bd2c/output.jpg 750w,\n/static/9156cfc6cd38dce72186cedd98de3ece/f1f81/output.jpg 799w","sizes":"100vw"},"sources":[{"srcSet":"/static/9156cfc6cd38dce72186cedd98de3ece/4ea96/output.webp 750w,\n/static/9156cfc6cd38dce72186cedd98de3ece/437f6/output.webp 799w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.9762202753441803}}}}},"next":{"fields":{"slug":"/DoppelGanger Python/"},"frontmatter":{"title":"Doppelganger Python","tags":["OpenCV","c++","Dlib"],"img":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC4UlEQVQoz2N4/vz53bv3Hj58+OTJ40ePHt2+efPFixfv3737+/fvfxTwD0b/gwsx/P///+fPH9+/ffvx4/vnz5/fvH/37fv3Hz9+fP78+fevn3/+/Pn06evjJ8+fPn915dqN8xcvX71x++nz12/effz56zfD37//Vi6b295c0tdZ3V6b15wV1Vmb19VeWV0Qe3D7qv///1+5/eT6gzeLV24KDAmLjY1NzMjbuPvw8Yt33rz/wvDv3//ywiwHc10vN2s/a/2VNdlJPo7xUd4JYY5b1y3+9///y3c/9hw8GRwcnJuaUlVYEBcbV1JWsm3/0TcfPjP8/fcvJiRAjINZnJ8n2t705sLODG8nSQEeSS6WSV3t////n7lmu29UUldy4Lfdq99snFWXHGZhY6Vv77xj/0GGP3//JoQHy/KxSwnwJjqb31g/vyU7TkpMQJiXra+r4////7ZxuQrG1hPz4lf3dqzqbCyM8heVU2JgYFq0bAXD379/Y0MDZfg4jHS0Q709ds3tLympsrJykJYS7+5q+///v75bsKWl9eHe6gMTqg5Obt3cmG9rbMzAwLp8xSpQaEcF+dpZWCWnFmRl5b159ignvyotpyowJGFCf+////9ltY0VZKQfzWs6M7X13pL+4+2ZcjJyDAxsy5avBPk5PjzYzz80Jb04K7v47PmLiSn5uUV1/qEpc+bM+/v3j7qxJQMT1/zGiudbNr7cs74mJoCBQ4iBgW3JspUMv379jAsL8fAOCQxLzMgqnjx1dkZuRUxirq1z0IJFy//+/aNjYc/AzO9q7bl85oyJ9dX+9j78oioM3ALLV68B+XnqxImV1U0V1U29fVNnzl5YW9+VlVteXNa4a/eBP3/+qBlaM7Dy84uoWenbxtg4aGrYsfBKMbAJLV25FuTnv2Dw58+f379+/f79+++fP3///AExwODx02e37ty7f//hs8dP37988ejB45u3796+ffft27cARP6nzydOVIYAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/e4f45c21a1e842bcef993f1a9c32ffd6/b3de9/Doppelganger.png","srcSet":"/static/e4f45c21a1e842bcef993f1a9c32ffd6/b3de9/Doppelganger.png 742w","sizes":"100vw"},"sources":[{"srcSet":"/static/e4f45c21a1e842bcef993f1a9c32ffd6/1f4dc/Doppelganger.webp 742w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.610512129380054}}}}}}},
    "staticQueryHashes": ["2478211480","63159454"]}