{
    "componentChunkName": "component---src-templates-blog-post-js",
    "path": "/DoppelGanger Python/",
    "result": {"data":{"site":{"siteMetadata":{"title":"Matthew Altenburg Portfolio","author":"Matthew Altenburg"}},"markdownRemark":{"id":"fa424c04-4729-5f17-a2ac-31cd5132bd55","excerpt":"In this project, I demonstrate how to use OpenCV and Dlib to create a celebrity look-alike application. The application works by converting a face into a highâ€¦","html":"<p>In this project, I demonstrate how to use OpenCV and Dlib to create a celebrity look-alike application.</p>\n<p>The application works by converting a face into a high-dimensional vector of points and then learns its feature space. Or put simply, it clusters the facial vector points together and then compares the distance between two clusters to determine if they are similar to each other.</p>\n<p>In order to keep the project simple, a smaller dataset was created in the celeb_mini folder and a NumPy array celeb_mapping.npy was used to link the image folders to names of the celebrities.</p>\n<p>Below is an overview video and diagram of my thought process with all code available in my GitHub repository.</p>\n<h2><a href=\"https://github.com/matthewaltenburg/DoppelGanger-Find-your-Celebrity-Look-Alike.git\" target=\"_blank\">Github code repository</a></h2>\n<p align=\"center\">\n<iframe\n    style=\"align:center\"\n    width=\"640\"\n    height=\"480\"\n    src=\"https://www.youtube.com/embed/pHm7vTRM4NU\"\n    frameborder=\"0\"\n    allowfullscreen\n>\n</iframe>\n</p>\n<h2>Overview diagram of the project</h2>\n<figure style=\"text-align: center;\">\n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 970px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/0024a2d9ebde7133ca46ab7b365089c5/f2aa2/output.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 69.95884773662551%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAOABQDASIAAhEBAxEB/8QAGAAAAwEBAAAAAAAAAAAAAAAAAAIEAwX/xAAUAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAHqPO4W5OI//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAECEgMRITH/2gAIAQEAAQUCTsR9Hx3rGOXZ/8QAFhEAAwAAAAAAAAAAAAAAAAAAARAR/9oACAEDAQE/ATF//8QAFxEAAwEAAAAAAAAAAAAAAAAAARARQf/aAAgBAgEBPwEXV//EABgQAQADAQAAAAAAAAAAAAAAAAABETFB/9oACAEBAAY/AkuKuWX1j//EABsQAQADAAMBAAAAAAAAAAAAAAEAETEhQVFx/9oACAEBAAE/IaiLz8me7qoGwh+jezjtrGmCV9+z/9oADAMBAAIAAwAAABAHP//EABYRAAMAAAAAAAAAAAAAAAAAAAEQQf/aAAgBAwEBPxCwX//EABYRAAMAAAAAAAAAAAAAAAAAAAEQQf/aAAgBAgEBPxCQL//EAB0QAQEAAgIDAQAAAAAAAAAAAAERACExUWGBsfD/2gAIAQEAAT8QuTF4Rpw1vUAkZ24g+W7HLoU3/OSvAR2Jq+8qCcP2Z//Z'); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/0024a2d9ebde7133ca46ab7b365089c5/fc615/output.avif 243w,\n/static/0024a2d9ebde7133ca46ab7b365089c5/b3175/output.avif 485w,\n/static/0024a2d9ebde7133ca46ab7b365089c5/006d3/output.avif 970w,\n/static/0024a2d9ebde7133ca46ab7b365089c5/1494e/output.avif 1137w\" sizes=\"(max-width: 970px) 100vw, 970px\" type=\"image/avif\"><source srcset=\"/static/0024a2d9ebde7133ca46ab7b365089c5/0e3e2/output.webp 243w,\n/static/0024a2d9ebde7133ca46ab7b365089c5/749af/output.webp 485w,\n/static/0024a2d9ebde7133ca46ab7b365089c5/dbca2/output.webp 970w,\n/static/0024a2d9ebde7133ca46ab7b365089c5/82968/output.webp 1137w\" sizes=\"(max-width: 970px) 100vw, 970px\" type=\"image/webp\">\n          <source srcset=\"/static/0024a2d9ebde7133ca46ab7b365089c5/3f316/output.jpg 243w,\n/static/0024a2d9ebde7133ca46ab7b365089c5/0d3a1/output.jpg 485w,\n/static/0024a2d9ebde7133ca46ab7b365089c5/ec7ce/output.jpg 970w,\n/static/0024a2d9ebde7133ca46ab7b365089c5/f2aa2/output.jpg 1137w\" sizes=\"(max-width: 970px) 100vw, 970px\" type=\"image/jpeg\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/0024a2d9ebde7133ca46ab7b365089c5/ec7ce/output.jpg\" alt=\"Image input and what is expected as output diagram\" title=\"Image input and what is expected as output diagram\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span>\n  <figcaption>Overview</figcaption>\n</figure>\n<h2>Python code</h2>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> glob\n<span class=\"token keyword\">import</span> dlib\n<span class=\"token keyword\">import</span> cv2\n<span class=\"token keyword\">import</span> numpy <span class=\"token keyword\">as</span> np\n<span class=\"token keyword\">import</span> matplotlib<span class=\"token punctuation\">.</span>pyplot <span class=\"token keyword\">as</span> plt\n\n<span class=\"token comment\"># Set up the the faceDetector, shapePredictor and faceRecognizer to</span>\n<span class=\"token comment\"># optimize speed as they are nedded by both functions.</span>\nfaceDetector <span class=\"token operator\">=</span> dlib<span class=\"token punctuation\">.</span>get_frontal_face_detector<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nshapePredictor <span class=\"token operator\">=</span> dlib<span class=\"token punctuation\">.</span>shape_predictor<span class=\"token punctuation\">(</span><span class=\"token string\">\"shape_predictor_68_face_landmarks.dat\"</span><span class=\"token punctuation\">)</span>\nfaceRecognizer <span class=\"token operator\">=</span> dlib<span class=\"token punctuation\">.</span>face_recognition_model_v1<span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"dlib_face_recognition_resnet_model_v1.dat\"</span>\n<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">inrole_data</span><span class=\"token punctuation\">(</span>faceDetector<span class=\"token punctuation\">,</span> shapePredictor<span class=\"token punctuation\">,</span> faceRecognizer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"This function creates a face descriptors of (1x128) for each face\n    in the images and stores them in in a NumPy array. It also creates a dictionary\n    to store the the index of array to names of the celebrity also in NumPy array.\n\n    Args:\n        faceDetector Dlib: used to detect faces in an image\n        shapePredictor Dlib: identifies the locations of import facial landmarks\n        faceRecognizer Dlib:  maps human faces into 128D vectors\n    \"\"\"</span>\n\n    <span class=\"token comment\"># create a dictionary to uses as a index for each face descriptors to celebrity name.</span>\n    index <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n    i <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n    <span class=\"token comment\"># create a NumPy array to store face descriptors</span>\n    faceDescriptors <span class=\"token operator\">=</span> <span class=\"token boolean\">None</span>\n\n    <span class=\"token comment\"># loop though the images in folders</span>\n    <span class=\"token keyword\">for</span> images <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span><span class=\"token string\">\"celeb_mini\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        imagefiles <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token string\">\"celeb_mini\"</span><span class=\"token punctuation\">,</span> images<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">for</span> image <span class=\"token keyword\">in</span> imagefiles<span class=\"token punctuation\">:</span>\n            imagePath <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token string\">\"celeb_mini\"</span><span class=\"token punctuation\">,</span> images<span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\">#  read each image and convert to a format form Dlib</span>\n            img <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>imagePath<span class=\"token punctuation\">)</span>\n            imDli <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>cvtColor<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>COLOR_BGR2RGB<span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\"># look for faces in image</span>\n            faces <span class=\"token operator\">=</span> faceDetector<span class=\"token punctuation\">(</span>imDli<span class=\"token punctuation\">)</span>\n\n            <span class=\"token comment\"># Create descriptor and index for each image</span>\n            <span class=\"token keyword\">for</span> face <span class=\"token keyword\">in</span> faces<span class=\"token punctuation\">:</span>\n\n                <span class=\"token comment\"># Find facial landmarks for each detected face</span>\n                shape <span class=\"token operator\">=</span> shapePredictor<span class=\"token punctuation\">(</span>imDli<span class=\"token punctuation\">,</span> face<span class=\"token punctuation\">)</span>\n\n                <span class=\"token comment\"># Compute face descriptor using neural network defined in Dlib.</span>\n                faceDescriptor <span class=\"token operator\">=</span> faceRecognizer<span class=\"token punctuation\">.</span>compute_face_descriptor<span class=\"token punctuation\">(</span>img<span class=\"token punctuation\">,</span> shape<span class=\"token punctuation\">)</span>\n\n                <span class=\"token comment\"># Convert face descriptor from Dlib's format to list, then a NumPy array</span>\n                faceDescriptorList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>x <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> faceDescriptor<span class=\"token punctuation\">]</span>\n                faceDescriptorNdarray <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>asarray<span class=\"token punctuation\">(</span>faceDescriptorList<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>float64<span class=\"token punctuation\">)</span>\n                faceDescriptorNdarray <span class=\"token operator\">=</span> faceDescriptorNdarray<span class=\"token punctuation\">[</span>np<span class=\"token punctuation\">.</span>newaxis<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n\n                <span class=\"token comment\"># add face descriptors to the faceDescriptor Numpy array.</span>\n                <span class=\"token keyword\">if</span> faceDescriptors <span class=\"token keyword\">is</span> <span class=\"token boolean\">None</span><span class=\"token punctuation\">:</span>\n                    faceDescriptors <span class=\"token operator\">=</span> faceDescriptorNdarray\n                <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                    faceDescriptors <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>concatenate<span class=\"token punctuation\">(</span>\n                        <span class=\"token punctuation\">(</span>faceDescriptors<span class=\"token punctuation\">,</span> faceDescriptorNdarray<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">0</span>\n                    <span class=\"token punctuation\">)</span>\n\n                <span class=\"token comment\"># map celebrity name corresponding to face descriptors and stored in NumPy Array</span>\n                index<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token string\">\"celeb_mapping.npy\"</span><span class=\"token punctuation\">,</span> allow_pickle<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>\n                    images\n                <span class=\"token punctuation\">]</span>\n                i <span class=\"token operator\">+=</span> <span class=\"token number\">1</span>\n    <span class=\"token comment\"># save</span>\n    np<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"index.npy\"</span><span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span>\n    np<span class=\"token punctuation\">.</span>save<span class=\"token punctuation\">(</span><span class=\"token string\">\"faceDescriptors.npy\"</span><span class=\"token punctuation\">,</span> faceDescriptors<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">lookalike</span><span class=\"token punctuation\">(</span>faceDetector<span class=\"token punctuation\">,</span> shapePredictor<span class=\"token punctuation\">,</span> faceRecognizer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token triple-quoted-string string\">\"\"\"This function loads images from the images folder and compares\n    them to prebuilt face descriptors to find the best match\n    for a celebrity look alike.\n\n    Args:\n        faceDetector Dlib: used to detect faces in an image\n        shapePredictor Dlib: identifies the locations of import facial landmarks\n        faceRecognizer Dlib:  maps human faces into 128D vectors\n    \"\"\"</span>\n    <span class=\"token comment\"># load face descriptors and the names index</span>\n    faceDescriptors <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token string\">\"faceDescriptors.npy\"</span><span class=\"token punctuation\">)</span>\n    index <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token string\">\"index.npy\"</span><span class=\"token punctuation\">,</span> allow_pickle<span class=\"token operator\">=</span><span class=\"token string\">\"TRUE\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># read image</span>\n    testImages <span class=\"token operator\">=</span> glob<span class=\"token punctuation\">.</span>glob<span class=\"token punctuation\">(</span><span class=\"token string\">\"images/*.jpg\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># loop though the images folder</span>\n    <span class=\"token keyword\">for</span> image <span class=\"token keyword\">in</span> testImages<span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># read the image and convert to Dlib format</span>\n        im <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>image<span class=\"token punctuation\">)</span>\n        imDli <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>cvtColor<span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>COLOR_BGR2RGB<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># detect faces</span>\n        faces <span class=\"token operator\">=</span> faceDetector<span class=\"token punctuation\">(</span>imDli<span class=\"token punctuation\">)</span>\n\n        <span class=\"token comment\"># create descriptor and index for each image</span>\n        <span class=\"token keyword\">for</span> face <span class=\"token keyword\">in</span> faces<span class=\"token punctuation\">:</span>\n            shape <span class=\"token operator\">=</span> shapePredictor<span class=\"token punctuation\">(</span>imDli<span class=\"token punctuation\">,</span> face<span class=\"token punctuation\">)</span>\n\n            faceDescriptor <span class=\"token operator\">=</span> faceRecognizer<span class=\"token punctuation\">.</span>compute_face_descriptor<span class=\"token punctuation\">(</span>im<span class=\"token punctuation\">,</span> shape<span class=\"token punctuation\">)</span>\n\n            faceDescriptorList <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>x <span class=\"token keyword\">for</span> x <span class=\"token keyword\">in</span> faceDescriptor<span class=\"token punctuation\">]</span>\n            faceDescriptorNdarray <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>asarray<span class=\"token punctuation\">(</span>faceDescriptorList<span class=\"token punctuation\">,</span> dtype<span class=\"token operator\">=</span>np<span class=\"token punctuation\">.</span>float64<span class=\"token punctuation\">)</span>\n            faceDescriptorNdarray <span class=\"token operator\">=</span> faceDescriptorNdarray<span class=\"token punctuation\">[</span>np<span class=\"token punctuation\">.</span>newaxis<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">:</span><span class=\"token punctuation\">]</span>\n\n            <span class=\"token comment\"># calculate the distances of the new face wiht face descriptors of celebrities</span>\n            distances <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>linalg<span class=\"token punctuation\">.</span>norm<span class=\"token punctuation\">(</span>faceDescriptors <span class=\"token operator\">-</span> faceDescriptorNdarray<span class=\"token punctuation\">,</span> axis<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n            argmin <span class=\"token operator\">=</span> np<span class=\"token punctuation\">.</span>argmin<span class=\"token punctuation\">(</span>distances<span class=\"token punctuation\">)</span>\n            minDistance <span class=\"token operator\">=</span> distances<span class=\"token punctuation\">[</span>argmin<span class=\"token punctuation\">]</span>\n\n            <span class=\"token comment\"># find an acceptable lookalike</span>\n            <span class=\"token keyword\">if</span> minDistance <span class=\"token operator\">&lt;=</span> <span class=\"token number\">0.8</span><span class=\"token punctuation\">:</span>\n                label <span class=\"token operator\">=</span> index<span class=\"token punctuation\">[</span>argmin<span class=\"token punctuation\">]</span>\n            <span class=\"token keyword\">else</span><span class=\"token punctuation\">:</span>\n                label <span class=\"token operator\">=</span> <span class=\"token string\">\"unknown\"</span>\n\n            celeb_name <span class=\"token operator\">=</span> label\n\n            <span class=\"token comment\"># load celebrity images from celeb_mini folder</span>\n            <span class=\"token keyword\">for</span> images <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span><span class=\"token string\">\"celeb_mini\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                imagefiles <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token string\">\"celeb_mini\"</span><span class=\"token punctuation\">,</span> images<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n                    np<span class=\"token punctuation\">.</span>load<span class=\"token punctuation\">(</span><span class=\"token string\">\"celeb_mapping.npy\"</span><span class=\"token punctuation\">,</span> allow_pickle<span class=\"token operator\">=</span><span class=\"token boolean\">True</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span>images<span class=\"token punctuation\">]</span>\n                    <span class=\"token operator\">==</span> celeb_name\n                <span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token keyword\">for</span> image <span class=\"token keyword\">in</span> imagefiles<span class=\"token punctuation\">:</span>\n                        img_cele <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>imread<span class=\"token punctuation\">(</span>os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span><span class=\"token string\">\"celeb_mini\"</span><span class=\"token punctuation\">,</span> images<span class=\"token punctuation\">,</span> image<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                        img_cele <span class=\"token operator\">=</span> cv2<span class=\"token punctuation\">.</span>cvtColor<span class=\"token punctuation\">(</span>img_cele<span class=\"token punctuation\">,</span> cv2<span class=\"token punctuation\">.</span>COLOR_BGR2RGB<span class=\"token punctuation\">)</span>\n                        <span class=\"token keyword\">break</span>\n\n        <span class=\"token comment\"># show images one at a time</span>\n        plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">121</span><span class=\"token punctuation\">)</span>\n        plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>imDli<span class=\"token punctuation\">)</span>\n        plt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">\"test img\"</span><span class=\"token punctuation\">)</span>\n\n        plt<span class=\"token punctuation\">.</span>subplot<span class=\"token punctuation\">(</span><span class=\"token number\">122</span><span class=\"token punctuation\">)</span>\n        plt<span class=\"token punctuation\">.</span>imshow<span class=\"token punctuation\">(</span>img_cele<span class=\"token punctuation\">)</span>\n        plt<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">\"Celeb Look-Alike={}\"</span><span class=\"token punctuation\">.</span><span class=\"token builtin\">format</span><span class=\"token punctuation\">(</span>celeb_name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n        plt<span class=\"token punctuation\">.</span>show<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n\n    <span class=\"token comment\"># to save time and not recreate the descriptors skip if the folder and index already exist</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>exists<span class=\"token punctuation\">(</span><span class=\"token string\">\"index.npy\"</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>exists<span class=\"token punctuation\">(</span><span class=\"token string\">\"faceDescriptors.npy\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"building face descriptors\"</span><span class=\"token punctuation\">)</span>\n        inrole_data<span class=\"token punctuation\">(</span>faceDetector<span class=\"token punctuation\">,</span> shapePredictor<span class=\"token punctuation\">,</span> faceRecognizer<span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\"># show posabale celebrity lookalikes</span>\n    lookalike<span class=\"token punctuation\">(</span>faceDetector<span class=\"token punctuation\">,</span> shapePredictor<span class=\"token punctuation\">,</span> faceRecognizer<span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">if</span> __name__ <span class=\"token operator\">==</span> <span class=\"token string\">\"__main__\"</span><span class=\"token punctuation\">:</span>\n    main<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>","frontmatter":{"title":"Doppelganger Python","date":"2021, Nov 17","tags":["OpenCV","c++","Dlib"],"img":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC4UlEQVQoz2N4/vz53bv3Hj58+OTJ40ePHt2+efPFixfv3737+/fvfxTwD0b/gwsx/P///+fPH9+/ffvx4/vnz5/fvH/37fv3Hz9+fP78+fevn3/+/Pn06evjJ8+fPn915dqN8xcvX71x++nz12/effz56zfD37//Vi6b295c0tdZ3V6b15wV1Vmb19VeWV0Qe3D7qv///1+5/eT6gzeLV24KDAmLjY1NzMjbuPvw8Yt33rz/wvDv3//ywiwHc10vN2s/a/2VNdlJPo7xUd4JYY5b1y3+9///y3c/9hw8GRwcnJuaUlVYEBcbV1JWsm3/0TcfPjP8/fcvJiRAjINZnJ8n2t705sLODG8nSQEeSS6WSV3t////n7lmu29UUldy4Lfdq99snFWXHGZhY6Vv77xj/0GGP3//JoQHy/KxSwnwJjqb31g/vyU7TkpMQJiXra+r4////7ZxuQrG1hPz4lf3dqzqbCyM8heVU2JgYFq0bAXD379/Y0MDZfg4jHS0Q709ds3tLympsrJykJYS7+5q+///v75bsKWl9eHe6gMTqg5Obt3cmG9rbMzAwLp8xSpQaEcF+dpZWCWnFmRl5b159ignvyotpyowJGFCf+////9ltY0VZKQfzWs6M7X13pL+4+2ZcjJyDAxsy5avBPk5PjzYzz80Jb04K7v47PmLiSn5uUV1/qEpc+bM+/v3j7qxJQMT1/zGiudbNr7cs74mJoCBQ4iBgW3JspUMv379jAsL8fAOCQxLzMgqnjx1dkZuRUxirq1z0IJFy//+/aNjYc/AzO9q7bl85oyJ9dX+9j78oioM3ALLV68B+XnqxImV1U0V1U29fVNnzl5YW9+VlVteXNa4a/eBP3/+qBlaM7Dy84uoWenbxtg4aGrYsfBKMbAJLV25FuTnv2Dw58+f379+/f79+++fP3///AExwODx02e37ty7f//hs8dP37988ejB45u3796+ffft27cARP6nzydOVIYAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/e4f45c21a1e842bcef993f1a9c32ffd6/b3de9/Doppelganger.png","srcSet":"/static/e4f45c21a1e842bcef993f1a9c32ffd6/b3de9/Doppelganger.png 742w","sizes":"100vw"},"sources":[{"srcSet":"/static/e4f45c21a1e842bcef993f1a9c32ffd6/859e4/Doppelganger.avif 742w","type":"image/avif","sizes":"100vw"},{"srcSet":"/static/e4f45c21a1e842bcef993f1a9c32ffd6/1f4dc/Doppelganger.webp 742w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.610512129380054}}}}}},"pageContext":{"slug":"/DoppelGanger Python/","previous":{"fields":{"slug":"/Virtual Makeup C++/"},"frontmatter":{"title":"Virtual Makeup C++","tags":["OpenCV","c++","Dlib"],"img":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAUABQDASIAAhEBAxEB/8QAGAABAQEBAQAAAAAAAAAAAAAAAAMFAgT/xAAUAQEAAAAAAAAAAAAAAAAAAAAC/9oADAMBAAIQAxAAAAG8p8h+NrkMTYC6hD//xAAaEAEAAwADAAAAAAAAAAAAAAABAAIDERIx/9oACAEBAAEFArJnHWa0631OdbA2cxjezPGzP//EABYRAQEBAAAAAAAAAAAAAAAAABABEf/aAAgBAwEBPwHCH//EABcRAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQIBAT8BpR5//8QAGxAAAgIDAQAAAAAAAAAAAAAAAAERIQIQEjH/2gAIAQEABj8CpTkxdYRJXmsYLOm7Fr//xAAbEAEBAQEAAwEAAAAAAAAAAAABEQAhQVFxof/aAAgBAQABPyGoGi5D8BmlSimiKUBuCPevboUeN2Qhugk5TMJ83//aAAwDAQACAAMAAAAQ+PCB/8QAGBEBAQADAAAAAAAAAAAAAAAAAQAQITH/2gAIAQMBAT8QBJvF7f/EABcRAQEBAQAAAAAAAAAAAAAAAAABITH/2gAIAQIBAT8QtJhyj//EABwQAQEBAAIDAQAAAAAAAAAAAAERACExQVFhcf/aAAgBAQABPxAZSzEFcACukBMoIAvzWQqFkvnEbVU1B6us6JB+Z0nQrx36yS65g68YTA6b/9k="},"images":{"fallback":{"src":"/static/9156cfc6cd38dce72186cedd98de3ece/f1f81/output.jpg","srcSet":"/static/9156cfc6cd38dce72186cedd98de3ece/2bd2c/output.jpg 750w,\n/static/9156cfc6cd38dce72186cedd98de3ece/f1f81/output.jpg 799w","sizes":"100vw"},"sources":[{"srcSet":"/static/9156cfc6cd38dce72186cedd98de3ece/4ea96/output.webp 750w,\n/static/9156cfc6cd38dce72186cedd98de3ece/437f6/output.webp 799w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.9762202753441803}}}}},"next":{"fields":{"slug":"/DoppelGanger C++/"},"frontmatter":{"title":"Doppelganger C++","tags":["OpenCV","c++","Dlib"],"img":{"childImageSharp":{"gatsbyImageData":{"layout":"fullWidth","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAIAAADtbgqsAAAACXBIWXMAAAsTAAALEwEAmpwYAAAC4UlEQVQoz2N4/vz53bv3Hj58+OTJ40ePHt2+efPFixfv3737+/fvfxTwD0b/gwsx/P///+fPH9+/ffvx4/vnz5/fvH/37fv3Hz9+fP78+fevn3/+/Pn06evjJ8+fPn915dqN8xcvX71x++nz12/effz56zfD37//Vi6b295c0tdZ3V6b15wV1Vmb19VeWV0Qe3D7qv///1+5/eT6gzeLV24KDAmLjY1NzMjbuPvw8Yt33rz/wvDv3//ywiwHc10vN2s/a/2VNdlJPo7xUd4JYY5b1y3+9///y3c/9hw8GRwcnJuaUlVYEBcbV1JWsm3/0TcfPjP8/fcvJiRAjINZnJ8n2t705sLODG8nSQEeSS6WSV3t////n7lmu29UUldy4Lfdq99snFWXHGZhY6Vv77xj/0GGP3//JoQHy/KxSwnwJjqb31g/vyU7TkpMQJiXra+r4////7ZxuQrG1hPz4lf3dqzqbCyM8heVU2JgYFq0bAXD379/Y0MDZfg4jHS0Q709ds3tLympsrJykJYS7+5q+///v75bsKWl9eHe6gMTqg5Obt3cmG9rbMzAwLp8xSpQaEcF+dpZWCWnFmRl5b159ignvyotpyowJGFCf+////9ltY0VZKQfzWs6M7X13pL+4+2ZcjJyDAxsy5avBPk5PjzYzz80Jb04K7v47PmLiSn5uUV1/qEpc+bM+/v3j7qxJQMT1/zGiudbNr7cs74mJoCBQ4iBgW3JspUMv379jAsL8fAOCQxLzMgqnjx1dkZuRUxirq1z0IJFy//+/aNjYc/AzO9q7bl85oyJ9dX+9j78oioM3ALLV68B+XnqxImV1U0V1U29fVNnzl5YW9+VlVteXNa4a/eBP3/+qBlaM7Dy84uoWenbxtg4aGrYsfBKMbAJLV25FuTnv2Dw58+f379+/f79+++fP3///AExwODx02e37ty7f//hs8dP37988ejB45u3796+ffft27cARP6nzydOVIYAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/e4f45c21a1e842bcef993f1a9c32ffd6/b3de9/Doppelganger.png","srcSet":"/static/e4f45c21a1e842bcef993f1a9c32ffd6/b3de9/Doppelganger.png 742w","sizes":"100vw"},"sources":[{"srcSet":"/static/e4f45c21a1e842bcef993f1a9c32ffd6/1f4dc/Doppelganger.webp 742w","type":"image/webp","sizes":"100vw"}]},"width":1,"height":0.610512129380054}}}}}}},
    "staticQueryHashes": ["2478211480","63159454"]}